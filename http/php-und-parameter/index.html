<!DOCTYPE html> 
<!--[if lt IE 7 ]> <html lang="en" class="no-js ie6 web-development"> <![endif]-->
<!--[if IE 7 ]>    <html lang="en" class="no-js ie7 web-development"> <![endif]-->
<!--[if IE 8 ]>    <html lang="en" class="no-js ie8 web-development"> <![endif]-->
<!--[if IE 9 ]>    <html lang="en" class="no-js ie9 web-development"> <![endif]-->
<!--[if (gt IE 9)|!(IE)]><!--> <html lang="en" class="no-js web-development"> <!--<![endif]-->
<head> 

  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">

  <title>Lehrbuch Web-Development - In PHP Daten aus Web-Formularen verarbeiten</title>
   
  <meta name="author" content="Brigitte Jellinek"> 
  <meta name="description" content="Ein Lehrbuch für das Informatik- oder Medieninformatik-Studium."> 

  <meta name="viewport" content="width=device-width; initial-scale=1.0; maximum-scale=1.0;">
  <meta name="generator" content="nanoc 3.1.6">

  <link rel="shortcut icon" href="/assets/img/favicon.ico">

  <link rel="stylesheet" href="/assets/css/bootstrap.css?v=1">
  <link rel="stylesheet" href="/assets/css/prettify.css?v=1">
  <style>
    body {  padding-top: 90px; }
    article {  padding-top: 40px; }
    body, p, li, dt, dd {  
      font-size: 15px; 
      line-height: 1.5 ;
    }
  </style>

  <script src="/assets/js/jquery.js?v=1.7.1"></script>
  <script src="/assets/js/bootstrap.js?v=1"></script>
  <script src="/assets/js/prettify.js?v=1"></script>
  <script src="/assets/js/libs/modernizr-1.5.min.js?v=1"></script>

</head>
<body>

<div class="container">

  <header class="jumbotron sub-header">
      <h1><a href="/" title="Web Development">Web Development</a></h1>
      <p class="lead">Ein Lehrbuch für das Informatik oder Medien-Informatik Studium.</p>
  </header>
    



	<!-- body -->
	<article id="body" class="row">
		
		<div class="span8">
		
			
                          <div class="page-header">
				<h2 class="title">In PHP Daten aus Web-Formularen verarbeiten</h2>
                          </div>
			
			
			<p>Der Zusammenhang zwischen Web-Formular, http-Request und den Arrays <code>$_POST</code> und <code>$_GET</code> in PHP sollte Ihnen schon klar sein.</p>

<h2 id="daten-prfen">Daten prüfen</h2>
<p>Die Daten aus einem Web-Formular werden vom PHP-Interpreter verarbeitet, die Codierung aufgelöst und die Daten dann in mehreren superglobalen12 Arrays zur Verfügung gestellt:</p>

<dl>
  <dt>$_GET</dt>
  <dd>Dieses Array enthält die Parameter einer GET-Anfrage. </dd>
  <dt>$_POST</dt>
  <dd>Dieses Array enthält die Parameter einer POST-Anfrage. </dd>
  <dt>$_REQUEST</dt>
  <dd>Dieses Array kombiniert die Daten aus $_GET und $_COOKIE und $_POST. Besser die spezifischen Arrays verwenden!</dd>
  <dt>$_FILE</dt>
  <dd>Enthält Daten von hochgeladenen Dateien</dd>
</dl>

<p>Warnhinweis: In frühen PHP Versionen konnte man noch direkt die Variable $nr verwenden um den Wert  aus einem Eingabefeld &lt;input name=”nr”&gt; zu lesen — das funktioniert heute nicht mehr! </p>

<p>Um einen GET-Request zu verarbeiten haben wir bisher ein sehr simples Programm verwendet:</p>

<pre><code>  &lt;?php
          $anzahl  = $_GET['anzahl'];
          $adresse = $_GET['adresse'];

          echo("&lt;p&gt;Ihre Bestellung über $anzahl Flugzeuge ist eingelangt&lt;/p&gt;");
          echo("&lt;p&gt;Die Flugzeuge werden binnen 1 Monat an $adresse geliefert&lt;/p&gt;");
  ?&gt; Dabei wird aber die Eingabe nicht geprüft. Eine bessere Version des Programmes prüft vorher jede Eingabe und gibt entsprechende Fehlermeldungen aus:

  &lt;?php
          $anzahl  = $_GET['anzahl'];
          $adresse = $_GET['adresse'];
          $ok = true;        // zeigt ob alle Eingaben ok sind
          $fehler = array(); // sammelt alle Fehlermeldungen
          if( (int) $anzahl != $anzahl or $anzahl &lt; 1) {
              $ok = false;
              $fehler[] = "Bitte geben Sie die Anzahl der Flugzeuge ein!";
          }
          if( strlen( $adresse ) &lt; 5 ) {
              $ok = false;
              $fehler[] = "Bitte geben Sie die vollständige Lieferadresse an!";
          }
          if ( ! $ok ) {
              echo("&lt;p&gt;Ihre Bestellung kann derzeit nicht bearbeitet werden:&lt;/p&gt;");
              echo("&lt;ol&gt;");
              foreach( $fehler as $fehler_text ) {
                  echo("&lt;li&gt;$fehler_text&lt;/li&gt;");
              }
              echo("&lt;/ol&gt;");
              echo("&lt;p&gt;Bitte gehen Sie zurück und bessern Sie die Bestellung aus.");
          }
          else {
              echo("&lt;p&gt;Ihre Bestellung über $anzahl Flugzeuge ist eingelangt&lt;/p&gt;");
              echo("&lt;p&gt;Die Flugzeuge werden binnen 1 Monat an $adresse geliefert&lt;/p&gt;");
          }
  ?&gt;
</code></pre>

<h2 id="datei-upload">Datei Upload</h2>
<p>POST ermöglicht das Senden beliebig langer Daten, und damit das Hochladen von ganzen Dateien. Dabei muss auch noch das enctype Attribut des Form-Tags gesetzt werden:</p>

<pre><code>  &lt;form action="upload.php" method="post" enctype="multipart/form-data"&gt; Neues Bild zum hochladen in den Ordner 

  &lt;a href='upload/'&gt;upload&lt;/a&gt;: &lt;input type="file" name="bild"&gt;
  &lt;input type="submit" value="hinaufladen"&gt;
  &lt;/form&gt; Der Input-Tag mit dem Typ „file“ wird vom Browser als Textfeld plus Button dargestellt. Wird der Button gedrückt dann erscheint ein Datei-Auswahl-Dialog, wie in Abbildung 132 gezeigt.
</code></pre>

<p><img  alt="Abbildung 136: Webformular mit Datei-Upload" src="/images/image345.png" /></p>

<p>Die Verarbeitung von hochgeladenen Dateien ist wesentlich komplizierter als die Behandlung anderen Requests: Die Dateien werden vom PHP-Interpreter temporär gespeichert. Das PHP-Programm kann die Dateien dann an einen permanenten Speicherort kopieren (falls das die Zugriffsrechte erlauben)</p>

<p>Die Details zu den Hochgeladenen Dateien sind im Array $_FILES gespeichert, in folgendem Beispiel hatte das Eingabefeld den Namen „bild“: </p>

<dl>
  <dt>$_FILES[‘bild’][‘name’]</dt>
  <dd>Der Originalname der Datei am Client. </dd>
  <dt>$_FILES[‘bild’][‘type’]</dt>
  <dd>Der „Mime Type“ der Datei – falls der Browser diese Information liefert. Zum Beispiel „image/gif“. Achtung: nicht zuverlässig! </dd>
  <dt>$_FILES[‘bild’][‘size’]</dt>
  <dd>Größe der hochgeladenen Datei in Byte. </dd>
  <dt>$_FILES[‘bild’][‘tmp_name’]</dt>
  <dd>Der Dateiname der temporären Datei. </dd>
  <dt>$_FILES[‘bild’][‘error’]</dt>
  <dd>Fehlercode bei Upload, 0 bedeutet dass kein Fehler aufgetreten ist. Siehe PHP-Doku.

    <pre><code>&lt;?php
$uploaddir = dirname( $_SERVER["SCRIPT_FILENAME"] ) . "/upload/";

$filename = basename($_FILES['bild']['name']);
$ext = substr($filename, -4);

if( $ext != '.jpg' ) {
   die("ich darf nur jpg-Dateien hochladen, nicht " . substr($filename, -3) );
}

$uploadfile = $uploaddir . $filename;

if (move_uploaded_file($_FILES['bild']['tmp_name'], $uploadfile)) {
    echo "Datei erfolgreich hochgeladen nach &lt;a href='upload/'&gt;upload/&lt;/a&gt;\n";
} else {
    echo "Problem beim Speichern der Datei.\n";
}

echo '&lt;pre&gt;debugging info:';
print_r($_FILES);
print '&lt;/pre&gt;';

?&gt;
</code></pre>
  </dd>
</dl>

<p>Achtung: Sie müssen den Ordner upload erstellen und ihm geeignete Zugriffsrechte zuweisen, damit der Webserver (= ein anderer Account) hineinschreiben darf!</p>

		
			<div class="pagination">
  <ul>
    
      <li><a href="/http/php-erzeugt/">← <span class="article">PHP erzeugt nicht nur HTML</a></li>
    
    
      <li><a href="/git/">GIT →</a></li>
    
  </ul>
</div>

		</div>
		
		<!-- sidebar -->
<div id="sidebar" class="span3 offset1">
        <div class="page-header"> 
        <h2>Kapitel</h2>
        </div>

        
        <ul class="nav nav-list">
        
          
            <li ><a href="/das-web-und-html/">DAS WEB UND HTML</a>
              <ul class="sub">
                
                  
                    
                      
                    
                      
                      <li ><a href="/das-web-und-html/geschichte/">Eine Kurze Geschichte des World Wide Web</a></li>
                      
                    
                      
                      <li ><a href="/das-web-und-html/standards/">Drei Standards definieren das Web</a></li>
                      
                    
                      
                      <li ><a href="/das-web-und-html/html-grundkurs/">HTML Grundkurs</a></li>
                      
                    
                      
                      <li ><a href="/das-web-und-html/upload/">Upload und Tools</a></li>
                      
                    
                  
                
              </ul>
            </li>
          
            <li ><a href="/css/">CSS</a>
              <ul class="sub">
                
                  
                    
                      
                    
                      
                      <li ><a href="/css/css-kurz/">Kurzvorstellung von Stylesheets</a></li>
                      
                    
                      
                      <li ><a href="/css/css/">Geschichte der Cascading Style Sheets</a></li>
                      
                    
                      
                      <li ><a href="/css/graceful/">Graceful Degradation</a></li>
                      
                    
                  
                
              </ul>
            </li>
          
            <li ><a href="/css-layout/">CSS LAYOUT</a>
              <ul class="sub">
                
                  
                    
                      
                    
                      
                      <li ><a href="/css-layout/rahmenbedingungen/">Rahmenbedingungen für Layout</a></li>
                      
                    
                      
                      <li ><a href="/css-layout/layout/">CSS für Layout</a></li>
                      
                    
                      
                      <li ><a href="/css-layout/selektoren/">CSS Selektoren</a></li>
                      
                    
                  
                
              </ul>
            </li>
          
            <li ><a href="/urls/">URLS</a>
              <ul class="sub">
                
                  
                    
                      
                    
                      
                      <li ><a href="/urls/absolut-relativ/">Absolute und relative URLs</a></li>
                      
                    
                      
                      <li ><a href="/urls/konfiguration/">Konfiguration</a></li>
                      
                    
                      
                      <li ><a href="/urls/tipps/">Pragmatische Tipps</a></li>
                      
                    
                  
                
              </ul>
            </li>
          
            <li ><a href="/formulare/">FORMULARE</a>
              <ul class="sub">
                
                  
                    
                      
                    
                      
                      <li ><a href="/formulare/16/">Formulare</a></li>
                      
                    
                      
                      <li ><a href="/formulare/17/">Daten absenden</a></li>
                      
                    
                      
                      <li ><a href="/formulare/18/">Formular und PHP</a></li>
                      
                    
                      
                      <li ><a href="/formulare/19/">Formular und Javascript</a></li>
                      
                    
                  
                
              </ul>
            </li>
          
            <li ><a href="/javascript-dom/">JAVASCRIPT DOM</a>
              <ul class="sub">
                
                  
                    
                      
                    
                      
                      <li ><a href="/javascript-dom/20/">Hintergründe</a></li>
                      
                    
                      
                      <li ><a href="/javascript-dom/21/">Basic Javascript</a></li>
                      
                    
                  
                
              </ul>
            </li>
          
            <li ><a href="/jquery/">JQUERY</a>
              <ul class="sub">
                
                  
                    
                      
                    
                      
                      <li ><a href="/jquery/22/">Unobstrusive Javascript</a></li>
                      
                    
                      
                      <li ><a href="/jquery/23/">Besondere Javascript-Schreibwesen in jQuery</a></li>
                      
                    
                      
                      <li ><a href="/jquery/24/">Selektieren und Manipulieren mit jQuery</a></li>
                      
                    
                      
                      <li ><a href="/jquery/25/">Interaktion mit jQuery</a></li>
                      
                    
                      
                      <li ><a href="/jquery/26/">Formulardaten Prüfen mit jQuery</a></li>
                      
                    
                  
                
              </ul>
            </li>
          
            <li ><a href="/php-vorbereitung/">PHP VORBEREITUNG</a>
              <ul class="sub">
                
                  
                    
                      
                    
                      
                      <li ><a href="/php-vorbereitung/was-ist-php/">Was ist PHP? Was passiert am Webserver?</a></li>
                      
                    
                      
                      <li ><a href="/php-vorbereitung/apache/">Apache</a></li>
                      
                    
                      
                      <li ><a href="/php-vorbereitung/erstes-php-programm/">Das erste PHP-Programm</a></li>
                      
                    
                  
                
              </ul>
            </li>
          
            <li class="active"><a href="/http/">HTTP</a>
              <ul class="sub">
                
                  
                    
                      
                    
                      
                      <li ><a href="/http/tcpip-und-dns/">TCP/IP und DNS</a></li>
                      
                    
                      
                      <li ><a href="/http/http/">HTTP</a></li>
                      
                    
                      
                      <li ><a href="/http/php-erzeugt/">PHP erzeugt nicht nur HTML</a></li>
                      
                    
                      
                      <li class="active"><a href="/http/php-und-parameter/">In PHP Daten aus Web-Formularen verarbeiten</a></li>
                      
                    
                  
                
              </ul>
            </li>
          
            <li ><a href="/git/">GIT</a>
              <ul class="sub">
                
                  
                    
                      
                    
                      
                      <li ><a href="/git/versionskontrolle/">Versionskontrolle</a></li>
                      
                    
                      
                      <li ><a href="/git/basic-git/">Einfacher Arbeitsablauf in Git</a></li>
                      
                    
                      
                      <li ><a href="/git/git-status/">Status von Git abfragen</a></li>
                      
                    
                  
                
              </ul>
            </li>
          
        
        </ul>

</div>
<!-- sidebar -->

		
	</article>
	<!-- /body -->


  <div class="row">
    <div class="span12" id="legal">
        <p class="copyright">veröffentlicht unter <a href="http://creativecommons.org/licenses/by-nc-sa/3.0/at/deed.de">creative commons by-nc-sa</a> im Jahr 2012 von <a href="#">Brigitte Jellinek</a>.
        <p>Zum Weiterentwickeln dieser Seite: <a href="https://github.com/bjelline/web-development-textbook/fork_select">Projekt forken</a> oder <a href="https://github.com/bjelline/web-development-textbook/blame/master/content/http/php-und-parameter.md">kommentar zu dieser seite</a></p>

</p>
    </div>
  </div>

</div> <!-- class="container" -->

<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.6.4/jquery.min.js"></script>
<script>!window.jQuery && document.write(unescape('%3Cscript src="/assets/js/libs/jquery-1.6.4.min.js"%3E%3C/script%3E'))</script>
<script>
  $(document).ready(function(){
    $('ul.nav ul.sub').hide();
    $('ul.nav li.active ul.sub').show();
  });
</script>
</body> 
</html>

